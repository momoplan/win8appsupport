(function(){var K=[];var i=[],w=[],Q=[],a=[],f=[],ai=[],ad=[],c;var z=0,V=0,U=1,R=0,u=1;var W=false,h=false,r=false,G=false;var ac=new pickAlgorithm();var D=window.Root;var ab=0,J=0,e;function aa(){x();redBall=M("redBall");redBall.addEventListener("click",P,false);var aj=M("addToList");aj.addEventListener("click",S,false);M("showChase").addEventListener("click",v,false);M("payBtn").addEventListener("click",E,false);M("restChose").addEventListener("click",L,false);M("multBox").addEventListener("click",p,false);M("lotmulti").addEventListener("change",af,false);M("startcase").addEventListener("click",m,false);M("toGift").addEventListener("click",B,false)}function P(ar){var aj=ar.target;var ak=aj.parentNode;if(aj.tagName.toLowerCase()=="a"){if(aj.className=="unable"){return}if(aj.className==""){if(ak.id=="bit"){i.push(aj.innerHTML);i.sort()}else{if(ak.id=="hundred"){w.push(aj.innerHTML);w.sort()}else{if(ak.id=="thousand"){Q.push(aj.innerHTML);Q.sort()}}}aj.className="checked"}else{aj.className="";if(ak.id=="bit"){O(i,aj.innerHTML)}else{if(ak.id=="hundred"){O(w,aj.innerHTML)}else{if(ak.id=="thousand"){O(Q,aj.innerHTML)}}}}q()}else{if(aj.tagName.toLowerCase()=="p"){var ap=ak.getElementsByTagName("a");var aq=(aj.innerHTML=="清")?"":"checked";for(var ao=0;ao<ap.length;ao++){ap[ao].className=aq}var an=[];if(ak.id=="bit"){i=[];an=i}else{if(ak.id=="hundred"){w=[];an=w}else{if(ak.id=="thousand"){Q=[];an=Q}}}if(aj.innerHTML!="清"){var al=0;for(var am=0;am<10;am++){an.push(al);al++}}q()}}}function S(){if(W){}else{if(z<1){M("bettingInfo").innerHTML="每行至少选择1个号码！";return}var ak='<div class="numLeft"><div><span class="redNums">'+i+'</span><span class="redNums">'+w+'</span><span class="redNums">'+Q+"</span></div><div>"+z+"注，"+z*2+'元</div></div><div class="numRight"><img sva='+z+' class="removeList" src="../images/icon/close.png" /></div><div class="clear"></div>';a.push(i);f.push(w);ai.push(Q)}var aj=document.createElement("li");aj.innerHTML=ak;aj.addEventListener("click",d,false);M("betList").appendChild(aj);V+=z;L();n()}function d(ak){var aj=ak.target;if(aj.tagName.toLowerCase()=="img"){V-=aj.getAttribute("sva");var am=M("betList").getElementsByTagName("li");for(var al=0;al<am.length;al++){if(am[al]==aj.parentNode.parentNode){a.splice(al,1);f.splice(al,1);ai.splice(al,1)}}M("betList").removeChild(aj.parentNode.parentNode);n()}}function O(aj,ak){for(var al=0;al<aj.length;al++){if(aj[al]==ak){aj.splice(al,1)}}}function q(){if(!W){var al=i.length,ak=w.length,aj=Q.length;z=ac.dddGetLottery(al,ak,aj);M("bettingInfo").innerHTML="您当前选中了"+z+"注，共"+z*2+"元"}}function L(){ae();if(c){c.className=""}i=[],w=[],Q=[];q()}function ae(){var ak=redBall.getElementsByTagName("a");for(var aj=0;aj<ak.length;aj++){ak[aj].className=""}}function T(){}function l(aj){}function y(){}function C(){}function o(){}function b(){}function v(){if(r||G){return}var aj=(U==1)?5:U;var al='    <div class="dialogDetail">        <div class="logTit">            <div class="titLeft">                <a onClick="closeDialog()" class="diaBtn" href="#">关闭</a>                </div>            <div class="titRight">                <a id="saveCh" class="diaBtn" href="javascript:;">保存</a>                </div>            <div class="titMidd">设置追期</div>        </div>        <div class="logCont">            <div class="chaseBox">                <div class="chaseTop">                    <div class="chaseTopLeft">                        <p class="fl">追期数：</p>                        <div class="chaseCtrl">                            <img id="chaseDel" src="../images/btn/chaseDel.png" />                            <div class="chaseInput">                                <input id="chaseNumber" value="5" type="text" />                            </div>                            <img id="chaseAdd" src="../images/btn/chaseAdd.png" />                        </div>                    </div>                    <div class="chaseTopRight">                            <p class="fl">中奖后停止追期:</p>                        <div class="closeBtn">                            <span id="isChaseStop" class="onoff"><label><i></i></label></span>                        </div>                    </div>                </div>                <div class="chaseMidd">                        <ul id="chaseMidd">                    </ul>                </div>                <div class="clear"></div>                <div class="chaseBtm">                    <a id="newPpayBtn" class="addToList" href="javascript:"><p>立即购买</p></a>				   </div>                <div class="clear h18"></div>            </div>                    </div>    </div>';var ak={width:850,height:450,isMask:true};D.dialog(al,ak);if(U>1){I(U);M("chaseNumber").value=aj}else{I(5)}M("newPpayBtn").addEventListener("click",E,false);M("chaseNumber").addEventListener("blur",j,false);M("isChaseStop").addEventListener("click",A,false);M("chaseDel").addEventListener("click",t,false);M("chaseAdd").addEventListener("click",N,false);M("saveCh").addEventListener("click",H,false)}function m(){if(h||G){return}var ak='    <div class="dialogDetail">        <div class="logTit">            <div class="titLeft">                <a onClick="closeDialog()" class="diaBtn" href="#">关闭</a>                </div>            <div class="titRight">                <a id="saveCase" class="diaBtn" href="#">保存</a>                </div>            <div class="titMidd">发起合买</div>        </div>        <div class="logCont">            <div class="chaseBox">                <div class="chaseMidd caseBox">                        <ul class="startcase">						   <li><p class="caseLeft">我要认购</p><p class="caseMidd"><input id="myPay" type="input" value="1" /></p><p class="caseRight" id="myOwn"></p></li>						   <li><p class="caseLeft">最低跟单</p><p class="caseMidd"><input id="minPay" type="text" value="1" /></p></li>						   <li><p class="caseLeft">我要保底</p><p class="caseMidd"><input id="allMyPay" type="text" value="1" /></p><p class="caseRight" id="myOwnPay"></p></li>						   <li><p class="caseLeft">提成比例</p><p class="caseMidd"><input id="commisionRation" type="text" value="10" />%</p><p class="caseRight">最高提成10%</p></li>						   <li><p class="caseLeft">是否可见</p><p class="caseMidd"><span id="caseVisibility" class="onoff"><label><i></i></label></span></p></li>                    </ul>                </div>                <div class="clear"></div>                <div class="chaseBtm">                    <a id="newPpayBtn" class="addToList" href="javascript:"><p>立即购买</p></a>				   </div>                <div class="clear h18"></div>            </div>                    </div>    </div>';var aj={width:850,height:335,isMask:true};D.dialog(ak,aj);M("myPay").addEventListener("change",ag,false);M("allMyPay").addEventListener("change",s,false);M("minPay").addEventListener("change",F,false);M("commisionRation").addEventListener("change",g,false);M("saveCase").addEventListener("click",k,false);M("newPpayBtn").addEventListener("click",E,false);M("caseVisibility").addEventListener("click",A,false)}function B(){if(h||r){return}var ak='    <div class="dialogDetail">        <div class="logTit">            <div class="titLeft">                <a onClick="closeDialog()" class="diaBtn" href="#">关闭</a>                </div>            <div class="titRight">                <a id="saveCase" class="diaBtn" href="#">保存</a>                </div>            <div class="titMidd">发起合买</div>        </div>        <div class="logCont">            <div class="chaseBox">                <div class="chaseMidd gift caseBox">                        <ul class="startcase">						   <li><p class="caseLeft">手机号码</p><p class="caseMidd"><input id="toPhone" type="input" value="1" /></p><p class="caseRight" id="myOwn"></p></li>						   <li><p class="caseLeft">赠送寄语</p><p class="caseMidd"><textarea id="toMessage"></textarea></p></li>                    </ul>                </div>                <div class="clear"></div>                <div class="chaseBtm">                    <a id="newPpayBtn" class="addToList" href="javascript:"><p>立即购买</p></a>				   </div>                <div class="clear h18"></div>            </div>                    </div>    </div>';var aj={width:850,height:335,isMask:true};D.dialog(ak,aj);M("saveCase").addEventListener("click",ah,false);M("newPpayBtn").addEventListener("click",E,false)}function j(){var ak=this.value;var aj=/^[1-9]\d*$/;if(ak==0||!aj.test(ak)){this.value=1;I(1);return}I(ak)}function ag(){var an=this.value;var al=/^[1-9]\d*$/;if(an==0||!al.test(an)){this.value=1}if(V==0){return}var ak=Number(M("lotmulti").value);var am=Number(M("myPay").value);var aj=(am*100)/(ak*V*2);aj=aj.toFixed(1);M("myOwn").innerHTML="占总额的"+aj+"%"}function F(){var ak=this.value;var aj=/^[1-9]\d*$/;if(ak==0||!aj.test(ak)){this.value=1}}function g(){var ak=this.value;var aj=/^[1-9]\d*$/;if(ak==0||!aj.test(ak)){this.value=1}if(ak>10){this.value=10}}function s(){var ak=Number(M("lotmulti").value);var am=Number(M("allMyPay").value);var al=/^[1-9]\d*$/;if(am==0||!al.test(am)){this.value=1;am=1}if(V==0){return}var aj=(am*100)/(ak*V*2);aj=aj.toFixed(1);M("myOwnPay").innerHTML="占总额的"+aj+"%"}function t(){var ak=M("chaseMidd").getElementsByTagName("li");var aj=ak.length-1;if(aj<1){return}M("chaseMidd").removeChild(ak[aj]);M("chaseNumber").value-=1}function N(){var aj=Number(M("chaseNumber").value);var ak='                        <li>                            <p class="chaseNum fl">                                '+(Number(batchcode)+aj)+'期                            </p>                            <p class="chasePrice">                                    <span>'+V*2+"</span>元                            </p>                        </li>";M("chaseMidd").innerHTML+=ak;M("chaseNumber").value=aj+1}function I(al){var ak="";for(var aj=0;aj<al;aj++){ak+='                        <li>                            <p class="chaseNum fl">                                '+(Number(batchcode)+aj)+'期                            </p>                            <p class="chasePrice">                                    <span>'+V*2+"</span>元                            </p>                        </li>"}M("chaseMidd").innerHTML=ak}function H(){U=Number(M("chaseNumber").value);closeDialog();M("curChase").innerHTML=U;h=(U!=1)?true:false;if(h){M("toGift").className="grey";M("startcase").className="grey"}else{M("toGift").className="";M("startcase").className=""}n()}function k(){ab=M("myPay").value;minAmt=M("minPay").value;J=M("allMyPay").value;commisionRation=M("commisionRation").value;var aj=M("caseVisibility").className;if(aj=="onoff"){isvisibility=0}else{isvisibility=1}closeDialog();ab*=100,J*=100,minAmt*=100;r=true;M("toGift").className="grey";M("showChase").className="grey"}function ah(){G=true;toPhone=M("toPhone").value;toMessage=M("toMessage").value;closeDialog();M("startcase").className="grey";M("showChase").className="grey"}function A(){if(this.className=="onoff"){this.className="onoff onoff-on";R=1}else{R=0;this.className="onoff"}}function af(){var aj=Number(M("lotmulti").value);u=aj;var ak=/^[1-9]\d*$/;if(aj==0||!ak.test(aj)){aj=1;this.value=1}else{if(aj>200){this.value=200}}n()}function n(){M("payNum").innerHTML="共"+V+"注，"+V*2*u*U+"元"}function E(){if(!sessionStorage.getItem("sessionid")){M("logBtn").click();return}if(V<1){M("payNum").innerHTML="请将您选择的号码加入到号码栏！";return}if(document.getElementById("saveCase")){document.getElementById("saveCase").click()}var aB="";var al=V*200;for(var ax=0;ax<a.length;ax++){var aq=a[ax].length,ay=f[ax].length,aC=ai[ax].length;console.log(aq+"ssss"+ay+"dddd"+aC);var an=ac.dddGetLottery(aq,ay,aC);var ar=(an*200);var au="",ak="",aD="";for(var at=0;at<aq;at++){au+="0"+a[ax][at]}for(var aw=0;aw<ay;aw++){aD+="0"+f[ax][aw]}for(var av=0;av<aC;av++){ak+="0"+ai[ax][av]}var aj=(aC<10)?"0"+aC:aC,ap=(ay<10)?"0"+ay:ay,am=(aq<10)?"0"+aq:aq;aB+="!2001"+aj+ak+"^"+ap+aD+"^"+am+au+"^_"+u+"_200_"+ar}var aA=aB.replace("!","");al*=u;var az;if(r){az={command:"betLot",bettype:"startcase",userno:sessionStorage.getItem("userno"),bet_code:aA,batchcode:batchcode,lotno:"F47103",lotmulti:u,amount:al,prizeend:R,oneAmount:"200",isSellWays:"1",buyAmt:ab,minAmt:minAmt,safeAmt:J,commisionRation:commisionRation,visibility:isvisibility}}else{if(G){az={command:"betLot",bettype:"gift",userno:sessionStorage.getItem("userno"),bet_code:aA,batchnum:U,batchcode:batchcode,lotno:"F47103",lotmulti:u,amount:al,prizeend:R,oneAmount:"200",isSellWays:"1",to_mobile_code:toPhone,blessing:toMessage}}else{az={command:"betLot",bettype:"bet",userno:sessionStorage.getItem("userno"),bet_code:aA,batchnum:U,batchcode:batchcode,lotno:"F47103",lotmulti:u,amount:al,prizeend:R,oneAmount:"200",isSellWays:"1"}}}var ao=util.stringify(az);sessionStorage.setItem("bet",ao);M("dialog").style.display="none";D.getData(az,"betResult")}function X(aj){var ak=aj;if(ak.error_code=="0000"){window.location.href="result/success.html?Ddd"}else{sessionStorage.setItem("res",ak.message);window.location.href="result/fail.html?Ddd"}}window.betResult=X;function p(){M("lotmulti").focus()}function x(){var aj={command:"QueryLot",type:"highFrequency",lotno:"F47103"};D.getData(aj,"setBatchcode")}function Z(aj){batchcode=aj.batchcode;M("batchCode").innerHTML=batchcode;M("endTime").innerHTML=aj.endtime;M("isLottery").style.display="block"}window.setBatchcode=Z;function Y(ak,aj){return ak-aj}function M(aj){return document.getElementById(aj)||new Object}aa()})();